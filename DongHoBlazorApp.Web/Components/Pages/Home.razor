@page "/"

<PageTitle>Trang Chủ</PageTitle>

@* <h1>Hello, world!</h1>

Welcome to your new app.
 *@


<!-- Main Content -->
<div class="main-content">
    <header class="top-header">
        <div class="header-left">
            <h1>Trang Chủ</h1>
            <p class="breadcrumb">Dashboard / Tổng Quan</p>
        </div>
        <div class="header-right">
            <div class="search-box">
                <input type="text" placeholder="Tìm kiếm...">
                <span class="search-icon">🔍</span>
            </div>
            <div class="notification">
                <span class="notification-icon">🔔</span>
                <span class="notification-badge">5</span>
            </div>
        </div>
    </header>

    @if (IsLoading)
    {
        <div class="loading-container">
            <div class="spinner"></div>
            <p>Đang tải dữ liệu...</p>
        </div>
    }
    else
    {
        <!-- Stats Cards -->
        <div class="stats-grid">
            <div class="stat-card purple">
                <div class="stat-icon">⌚</div>
                <div class="stat-info">
                    <h3>@Report.TotalProducts.ToString("N0")</h3>
                    <p>Tổng Sản Phẩm</p>
                    <span class="stat-change positive">+12% tháng này</span>
                </div>
            </div>
            <div class="stat-card blue">
                <div class="stat-icon">🛒</div>
                <div class="stat-info">
                    <h3>@Report.TotalOrders.ToString("N0")</h3>
                    <p>Đơn Hàng</p>
                    <span class="stat-change positive">+8% tháng này</span>
                </div>
            </div>
            <div class="stat-card green">
                <div class="stat-icon">💰</div>
                <div class="stat-info">
                    <h3>@((Report.TotalRevenue / 1000000000m).ToString("N1")) tỷ</h3>
                    <p>Doanh Thu</p>
                    <span class="stat-change positive">+15% tháng này</span>
                </div>
            </div>
            <div class="stat-card orange">
                <div class="stat-icon">👥</div>
                <div class="stat-info">
                    <h3>@Report.TotalCustomers.ToString("N0")</h3>
                    <p>Khách Hàng</p>
                    <span class="stat-change positive">+5% tháng này</span>
                </div>
            </div>
        </div>

        <!-- Charts and Tables -->
        <div class="content-grid">
            <div class="card chart-card">
                <div class="card-header">
                    <h3>Doanh Thu Theo Tháng</h3>
                    <select class="filter-select" @onchange="OnFilterChanged" value="@SelectedFilter">
                        <option value="7 ngày qua">7 ngày qua</option>
                        <option value="30 ngày qua">30 ngày qua</option>
                        <option value="Tháng này">Tháng này</option>
                        <option value="Quý này">Quý này</option>
                        <option value="Năm nay">Năm nay</option>
                    </select>
                </div>
                <div class="chart-placeholder">
                    <div class="bar-chart">
                        @foreach (var month in Report.RevenueByMonth)
                        {
                            var maxRev = Report.RevenueByMonth.Max(x => x.Revenue);
                            var height = maxRev > 0 ? (int)(month.Revenue / maxRev * 100) : 0;
                            <div class="bar" style="height: @(height)%"><span>@month.Month</span></div>
                        }
                    </div>
                </div>
            </div>

            <div class="card">
                <div class="card-header">
                    <h3>Sản Phẩm Bán Chạy</h3>
                    <a href="/DongHo" class="view-all">Xem tất cả →</a>
                </div>
                <div class="product-list">
                    @foreach (var prod in Report.TopSellingProducts)
                    {
                        <div class="product-item">
                            <div class="product-img">⌚</div>
                            <div class="product-details">
                                <h4>@prod.ProductName</h4>
                                <p>Đã bán: @prod.SalesCount chiếc</p>
                            </div>
                            <div class="product-price">@prod.Price.ToString("#,### ₫")</div>
                        </div>
                    }
                </div>
            </div>
        </div>

        <!-- Recent Orders -->
        <div class="card">
            <div class="card-header">
                <h3>Đơn Hàng Gần Đây</h3>
                <a href="/DonHang" class="view-all">Xem tất cả →</a>
            </div>
            <div class="table-responsive">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Mã ĐH</th>
                            <th>Khách Hàng</th>
                            <th>Sản Phẩm</th>
                            <th>Ngày Đặt</th>
                            <th>Tổng Tiền</th>
                            <th>Trạng Thái</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var order in Report.RecentOrders)
                        {
                            <tr>
                                <td>#ORD-@order.OrderId.ToString("D3")</td>
                                <td>@order.CustomerName</td>
                                <td>@order.ProductName</td>
                                <td>@order.OrderDate.ToString("dd/MM/yyyy")</td>
                                <td>@order.TotalAmount.ToString("#,### ₫")</td>
                                <td>
                                    @{
                                        var statusClass = order.Status switch
                                        {
                                            "Hoàn thành" => "success",
                                            "Đang xử lý" => "pending",
                                            "Đang giao" => "shipping",
                                            "Đã hủy" => "cancelled",
                                            _ => "pending"
                                        };
                                    }
                                    <span class="status @statusClass">@order.Status</span>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
</div>